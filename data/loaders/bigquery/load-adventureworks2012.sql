-- Load adventureworks2012 data
--
-- NOTE: if possible, create a project name `atscale-tutorial-data` first and run these scripts there
--
--
CREATE SCHEMA IF NOT EXISTS `adventureworks2012`;

LOAD DATA OVERWRITE adventureworks2012.datecustom (pk_date TIMESTAMP, datekey INT64, date_name STRING, year TIMESTAMP, year_name STRING, half_year TIMESTAMP, half_year_name STRING, quarter TIMESTAMP, quarter_name STRING, month TIMESTAMP, month_name STRING, week TIMESTAMP, week_name STRING, day_of_year INT64, day_of_year_name STRING, day_of_half_year INT64, day_of_half_year_name STRING, day_of_quarter INT64, day_of_quarter_name STRING, day_of_month INT64, day_of_month_name STRING, day_of_week INT64, day_of_week_name STRING, week_of_year INT64, week_of_year_name STRING, month_of_year INT64, month_of_year_name STRING, month_of_half_year INT64, month_of_half_year_name STRING, month_of_quarter INT64, month_of_quarter_name STRING, quarter_of_year INT64, quarter_of_year_name STRING, quarter_of_half_year INT64, quarter_of_half_year_name STRING, half_year_of_year INT64, half_year_of_year_name STRING, reporting_year TIMESTAMP, reporting_year_name STRING, reporting_half_year TIMESTAMP, reporting_half_year_name STRING, reporting_quarter TIMESTAMP, reporting_quarter_name STRING, reporting_month TIMESTAMP, reporting_month_name STRING, reporting_month_name2 STRING, reporting_week TIMESTAMP, reporting_week_name STRING, reporting_day TIMESTAMP, reporting_day_name STRING, reporting_day_of_year INT64, reporting_day_of_year_name STRING, reporting_day_of_half_year INT64, reporting_day_of_half_year_name STRING, reporting_day_of_quarter INT64, reporting_day_of_quarter_name STRING, reporting_day_of_month INT64, reporting_day_of_month_name STRING, reporting_day_of_week INT64, reporting_day_of_week_name STRING, reporting_week_of_year INT64, reporting_week_of_year_name STRING, reporting_week_of_half_year INT64, reporting_week_of_half_year_name STRING, reporting_week_of_quarter INT64, reporting_week_of_quarter_name STRING, reporting_week_of_month INT64, reporting_week_of_month_name STRING, reporting_month_of_year INT64, reporting_month_of_year_name STRING, reporting_month_of_half_year INT64, reporting_month_of_half_year_name STRING, reporting_month_of_quarter INT64, reporting_month_of_quarter_name STRING, reporting_quarter_of_year INT64, reporting_quarter_of_year_name STRING, reporting_quarter_of_half_year INT64, reporting_quarter_of_half_year_name STRING, reporting_half_year_of_year INT64, reporting_half_year_of_year_name STRING, iso_8601_year TIMESTAMP, iso_8601_year_name STRING, iso_8601_week TIMESTAMP, iso_8601_week_name STRING, iso_8601_day TIMESTAMP, iso_8601_day_name STRING, iso_8601_day_of_year INT64, iso_8601_day_of_year_name STRING, iso_8601_day_of_week INT64, iso_8601_day_of_week_name STRING, iso_8601_week_of_year INT64, iso_8601_week_of_year_name_reporting_day_ctl STRING, reporting_day_lykey TIMESTAMP, reporting_week_ctl TIMESTAMP, reporting_week_lykey TIMESTAMP, reporting_month_lykey TIMESTAMP, reporting_quarter_lykey TIMESTAMP, reporting_half_year_lykey TIMESTAMP, reporting_year_lykey TIMESTAMP) FROM FILES (format = 'CSV', field_delimiter = '\t', skip_leading_rows = 1, uris = ['gs://atscale_tutorial_data/adventureworks2012/datecustom.csv']);

LOAD DATA OVERWRITE adventureworks2012.dimaccount (accountkey INT64, parentaccountkey INT64, accountcodealternatekey INT64, parentaccountcodealternatekey INT64, accountdescription STRING, accounttype STRING, operator STRING, custommembers STRING, valuetype STRING, custommemberoptions STRING) FROM FILES (format = 'CSV', field_delimiter = '\t', skip_leading_rows = 1, uris = ['gs://atscale_tutorial_data/adventureworks2012/dimaccount.csv']);

LOAD DATA OVERWRITE adventureworks2012.dimcurrency (currencykey INT64, currencyalternatekey STRING, currencyname STRING) FROM FILES (format = 'CSV', field_delimiter = '\t', skip_leading_rows = 1, uris = ['gs://atscale_tutorial_data/adventureworks2012/dimcurrency.csv']);

LOAD DATA OVERWRITE adventureworks2012.dimcustomer (customerkey INT64, geographykey INT64, customeralternatekey STRING, title STRING, firstname STRING, middlename STRING, lastname STRING, namestyle BOOLEAN, birthdate DATE, maritalstatus STRING, suffix STRING, gender STRING, emailaddress STRING, yearlyincome FLOAT64, totalchildren INT64, numberchildrenathome INT64, englisheducation STRING, spanisheducation STRING, frencheducation STRING, englishoccupation STRING, spanishoccupation STRING, frenchoccupation STRING, houseownerflag INT64, numbercarsowned INT64, addressline1 STRING, addressline2 STRING, phone STRING, datefirstpurchase DATE, commutedistance STRING) FROM FILES (format = 'CSV', field_delimiter = '\t', skip_leading_rows = 1, uris = ['gs://atscale_tutorial_data/adventureworks2012/dimcustomer.csv']);

LOAD DATA OVERWRITE adventureworks2012.dimdepartmentgroup (departmentgroupkey INT64, parentdepartmentgroupkey INT64, departmentgroupname STRING) FROM FILES (format = 'CSV', field_delimiter = '\t', skip_leading_rows = 1, uris = ['gs://atscale_tutorial_data/adventureworks2012/dimdepartmentgroup.csv']);

LOAD DATA OVERWRITE adventureworks2012.dimgeography (geographykey INT64, city STRING, stateprovincecode STRING, stateprovincename STRING, countryregioncode STRING, englishcountryregionname STRING, spanishcountryregionname STRING, frenchcountryregionname STRING, postalcode STRING, salesterritorykey INT64, ipaddresslocator STRING) FROM FILES (format = 'CSV', field_delimiter = '\t', skip_leading_rows = 1, uris = ['gs://atscale_tutorial_data/adventureworks2012/dimgeography.csv']);

LOAD DATA OVERWRITE adventureworks2012.dimorganization (organizationkey INT64, parentorganizationkey INT64, percentageofownership FLOAT64, organizationname STRING, currencykey INT64) FROM FILES (format = 'CSV', field_delimiter = '\t', skip_leading_rows = 1, uris = ['gs://atscale_tutorial_data/adventureworks2012/dimorganization.csv']);

LOAD DATA OVERWRITE adventureworks2012.dimproduct (productkey INT64, productalternatekey STRING, productsubcategorykey INT64, weightunitmeasurecode STRING, sizeunitmeasurecode STRING, englishproductname STRING, spanishproductname STRING, frenchproductname STRING, standardcost FLOAT64, finishedgoodsflag BOOLEAN, color STRING, safetystocklevel INT64, reorderpoint INT64, listprice FLOAT64, size STRING, sizerange STRING, weight FLOAT64, daystomanufacture INT64, productline STRING, dealerprice FLOAT64, class STRING, style STRING, modelname STRING, largephoto STRING, englishdescription STRING, frenchdescription STRING, chinesedescription STRING, arabicdescription STRING, hebrewdescription STRING, thaidescription STRING, germandescription STRING, japanesedescription STRING, turkishdescription STRING, startdate TIMESTAMP, enddate TIMESTAMP, status STRING) FROM FILES (format = 'CSV', field_delimiter = '\t', skip_leading_rows = 1, uris = ['gs://atscale_tutorial_data/adventureworks2012/dimproduct.csv']);

LOAD DATA OVERWRITE adventureworks2012.dimproductcategory (productcategorykey INT64, productcategoryalternatekey INT64, englishproductcategoryname STRING, spanishproductcategoryname STRING, frenchproductcategoryname STRING) FROM FILES (format = 'CSV', field_delimiter = '\t', skip_leading_rows = 1, uris = ['gs://atscale_tutorial_data/adventureworks2012/dimproductcategory.csv']);

LOAD DATA OVERWRITE adventureworks2012.dimproductsubcategory (productsubcategorykey INT64, productsubcategoryalternatekey INT64, englishproductsubcategoryname STRING, spanishproductsubcategoryname STRING, frenchproductsubcategoryname STRING, productcategorykey INT64) FROM FILES (format = 'CSV', field_delimiter = '\t', skip_leading_rows = 1, uris = ['gs://atscale_tutorial_data/adventureworks2012/dimproductsubcategory.csv']);

LOAD DATA OVERWRITE adventureworks2012.dimreseller (resellerkey INT64, geographykey INT64, reselleralternatekey STRING, phone STRING, businesstype STRING, resellername STRING, numberemployees INT64, orderfrequency STRING, ordermonth INT64, firstorderyear INT64, lastorderyear INT64, productline STRING, addressline1 STRING, addressline2 STRING, annualsales FLOAT64, bankname STRING, minpaymenttype INT64, minpaymentamount FLOAT64, annualrevenue FLOAT64, yearopened INT64) FROM FILES (format = 'CSV', field_delimiter = '\t', skip_leading_rows = 1, uris = ['gs://atscale_tutorial_data/adventureworks2012/dimreseller.csv']);

LOAD DATA OVERWRITE adventureworks2012.dimsalesreason (salesreasonkey INT64, salesreasonalternatekey INT64, salesreasonname STRING, salesreasonreasontype STRING) FROM FILES (format = 'CSV', field_delimiter = '\t', skip_leading_rows = 1, uris = ['gs://atscale_tutorial_data/adventureworks2012/dimsalesreason.csv']);

LOAD DATA OVERWRITE adventureworks2012.dimsalesterritory (salesterritorykey INT64, salesterritoryalternatekey INT64, salesterritoryregion STRING, salesterritorycountry STRING, salesterritorygroup STRING, salesterritoryimage STRING) FROM FILES (format = 'CSV', field_delimiter = '\t', skip_leading_rows = 1, uris = ['gs://atscale_tutorial_data/adventureworks2012/dimsalesterritory.csv']);

LOAD DATA OVERWRITE adventureworks2012.dimscenario (scenariokey INT64, scenarioname STRING) FROM FILES (format = 'CSV', field_delimiter = '\t', skip_leading_rows = 1, uris = ['gs://atscale_tutorial_data/adventureworks2012/dimscenario.csv']);

LOAD DATA OVERWRITE adventureworks2012.factcurrencyrate (currencykey INT64, datekey INT64, averagerate FLOAT64, endofdayrate FLOAT64, date STRING) FROM FILES (format = 'CSV', field_delimiter = '\t', skip_leading_rows = 1, uris = ['gs://atscale_tutorial_data/adventureworks2012/factcurrencyrate.csv']);

LOAD DATA OVERWRITE adventureworks2012.factfinance (financekey INT64, datekey INT64, organizationkey INT64, departmentgroupkey INT64, scenariokey INT64, accountkey INT64, amount FLOAT64, date STRING) FROM FILES (format = 'CSV', field_delimiter = '\t', skip_leading_rows = 1, uris = ['gs://atscale_tutorial_data/adventureworks2012/factfinance.csv']);

LOAD DATA OVERWRITE adventureworks2012.factinternetsales (productkey INT64, orderdatekey INT64, duedatekey INT64, shipdatekey INT64, customerkey INT64, promotionkey INT64, currencykey INT64, salesterritorykey INT64, salesordernumber STRING, salesorderlinenumber INT64, revisionnumber INT64, orderquantity INT64, unitprice FLOAT64, extendedamount FLOAT64, unitpricediscountpct INT64, discountamount INT64, productstandardcost FLOAT64, totalproductcost FLOAT64, salesamount FLOAT64, taxamt FLOAT64, freight FLOAT64, carriertrackingnumber STRING, customerponumber STRING, orderdate TIMESTAMP, duedate TIMESTAMP, shipdate TIMESTAMP) FROM FILES (format = 'CSV', field_delimiter = '\t', skip_leading_rows = 1, uris = ['gs://atscale_tutorial_data/adventureworks2012/factinternetsales.csv']);

LOAD DATA OVERWRITE adventureworks2012.factinternetsalesreason (salesordernumber STRING, salesorderlinenumber INT64, salesreasonkey INT64) FROM FILES (format = 'CSV', field_delimiter = '\t', skip_leading_rows = 1, uris = ['gs://atscale_tutorial_data/adventureworks2012/factinternetsalesreason.csv']);

LOAD DATA OVERWRITE adventureworks2012.factresellersales (productkey INT64, orderdatekey INT64, duedatekey INT64, shipdatekey INT64, resellerkey INT64, employeekey INT64, promotionkey INT64, currencykey INT64, salesterritorykey INT64, salesordernumber STRING, salesorderlinenumber INT64, revisionnumber INT64, orderquantity INT64, unitprice FLOAT64, extendedamount FLOAT64, unitpricediscountpct FLOAT64, discountamount FLOAT64, productstandardcost FLOAT64, totalproductcost FLOAT64, salesamount FLOAT64, taxamt FLOAT64, freight FLOAT64, carriertrackingnumber STRING, customerponumber STRING, orderdate TIMESTAMP, duedate TIMESTAMP, shipdate TIMESTAMP) FROM FILES (format = 'CSV', field_delimiter = '\t', skip_leading_rows = 1, uris = ['gs://atscale_tutorial_data/adventureworks2012/factresellersales.csv']);

LOAD DATA OVERWRITE adventureworks2012.factsalesquota (salesquotakey INT64, employeekey INT64, datekey INT64, calendaryear INT64, calendarquarter INT64, salesamountquota FLOAT64, date STRING) FROM FILES (format = 'CSV', field_delimiter = '\t', skip_leading_rows = 1, uris = ['gs://atscale_tutorial_data/adventureworks2012/factsalesquota.csv']);